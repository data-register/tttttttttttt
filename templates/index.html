<!DOCTYPE html>
<html>
<head>
    <title>{{ title }}</title>
    <meta http-equiv="refresh" content="300">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 1000px; 
            margin: 0 auto; 
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 { color: #0066cc; text-align: center; }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .modules-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        .module-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            width: 300px;
            transition: transform 0.3s;
        }
        .module-card:hover {
            transform: translateY(-5px);
        }
        .module-icon {
            font-size: 48px;
            text-align: center;
            margin-bottom: 10px;
        }
        .module-title {
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
        }
        .module-description {
            font-size: 14px;
            text-align: center;
            margin-bottom: 15px;
        }
        .module-status {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .status-active {
            background-color: #28a745;
        }
        .status-inactive {
            background-color: #dc3545;
        }
        .status-warning {
            background-color: #ffc107;
        }
        .module-button {
            display: block;
            text-align: center;
            background-color: #0066cc;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            transition: background-color 0.3s;
        }
        .module-button:hover {
            background-color: #0055aa;
        }
        .main-image {
            text-align: center;
            margin: 20px 0;
        }
        .main-image img {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>PTZ Camera Control System</h1>
        <p>–°–∏—Å—Ç–µ–º–∞ –∑–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ ONVIF PTZ –∫–∞–º–µ—Ä–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω —Ü–∏–∫—ä–ª</p>
    </div>
    
    <div class="main-image">
        <img src="/latest.jpg?ts={{ timestamp }}" alt="–¢–µ–∫—É—â –∫–∞–¥—ä—Ä –æ—Ç –∫–∞–º–µ—Ä–∞—Ç–∞">
    </div>
    
    <div class="modules-container">
        <!-- PTZ Control Module -->
        <div class="module-card">
            <div class="module-icon">üéÆ</div>
            <div class="module-title">PTZ Control</div>
            <div class="module-description">
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ PTZ –∫–∞–º–µ—Ä–∞—Ç–∞ –∏ –ø—Ä–µ—Å–µ—Ç–∏—Ç–µ
            </div>
            <div class="module-status">
                <div class="status-indicator status-{{ 'active' if ptz_config.status == 'ok' else 'warning' if ptz_config.status == 'initializing' else 'inactive' }}"></div>
                <span>{{ '–ê–∫—Ç–∏–≤–µ–Ω' if ptz_config.status == 'ok' else '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–µ' if ptz_config.status == 'initializing' else '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω' }}</span>
            </div>
            <a href="/ptz" class="module-button">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</a>
        </div>
        
        <!-- Capture Module -->
        <div class="module-card">
            <div class="module-icon">üì∏</div>
            <div class="module-title">Image Capture</div>
            <div class="module-description">
                –ó–∞—Å–Ω–µ–º–∞–Ω–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç –∫–∞–º–µ—Ä–∞—Ç–∞
            </div>
            <div class="module-status">
                <div class="status-indicator status-{{ 'active' if capture_config.status == 'ok' else 'warning' if capture_config.status == 'initializing' else 'inactive' }}"></div>
                <span>{{ '–ê–∫—Ç–∏–≤–µ–Ω' if capture_config.status == 'ok' else '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–µ' if capture_config.status == 'initializing' else '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω' }}</span>
            </div>
            <a href="/capture/capture_now" class="module-button">–ù–∞–ø—Ä–∞–≤–∏ —Å–Ω–∏–º–∫–∞</a>
        </div>
        
        <!-- Current Configuration -->
        <div class="module-card">
            <div class="module-icon">‚öôÔ∏è</div>
            <div class="module-title">–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</div>
            <div class="module-description">
                –¢–µ–∫—É—â–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ç–∞
            </div>
            <div class="module-status">
                <div class="status-indicator status-{{ 'active' if ptz_config.status == 'ok' and capture_config.status == 'ok' else 'warning' }}"></div>
                <span>{{ '–ê–∫—Ç–∏–≤–Ω–∞' if ptz_config.status == 'ok' and capture_config.status == 'ok' else '–ß–∞—Å—Ç–∏—á–Ω–æ –∞–∫—Ç–∏–≤–Ω–∞' }}</span>
            </div>
            <a href="/health" class="module-button">–ü—Ä–æ–≤–µ—Ä–∫–∞</a>
        </div>
    </div>
    
    <div class="modules-container" style="margin-top: 20px;">
        <!-- Automatic Mode Control -->
        <div class="module-card">
            <div class="module-icon">üîÑ</div>
            <div class="module-title">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω —Ä–µ–∂–∏–º</div>
            <div class="module-description">
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—è —Ü–∏–∫—ä–ª
            </div>
            <div class="module-status">
                <div class="status-indicator status-{{ 'active' if ptz_config.is_scheduled_mode else 'inactive' }}"></div>
                <span>{{ '–í–∫–ª—é—á–µ–Ω' if ptz_config.is_scheduled_mode else '–ò–∑–∫–ª—é—á–µ–Ω' }}</span>
            </div>
            <div style="display: flex; gap: 10px;">
                <a href="/ptz/automatic/on" class="module-button" style="flex: 1">–í–∫–ª—é—á–∏</a>
                <a href="/ptz/automatic/off" class="module-button" style="flex: 1; background-color: #dc3545;">–ò–∑–∫–ª—é—á–∏</a>
            </div>
        </div>
        
        <!-- Current Position -->
        <div class="module-card">
            <div class="module-icon">üìç</div>
            <div class="module-title">–¢–µ–∫—É—â–∞ –ø–æ–∑–∏—Ü–∏—è</div>
            <div class="module-description">
                –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ —Ç–µ–∫—É—â–∞—Ç–∞ –ø–æ–∑–∏—Ü–∏—è
            </div>
            <div class="module-status">
                <div class="status-indicator status-{{ 'active' if ptz_config.status == 'ok' else 'inactive' }}"></div>
                <span>–ü—Ä–µ—Å–µ—Ç: {{ ptz_config.current_preset }}</span>
            </div>
            <a href="/ptz/status" class="module-button">–î–µ—Ç–∞–π–ª–∏</a>
        </div>
        
        <!-- Latest Frame -->
        <div class="module-card">
            <div class="module-icon">üñºÔ∏è</div>
            <div class="module-title">–ü–æ—Å–ª–µ–¥–µ–Ω –∫–∞–¥—ä—Ä</div>
            <div class="module-description">
                –ü–æ—Å–ª–µ–¥–µ–Ω –∑–∞—Å–Ω–µ—Ç –∫–∞–¥—ä—Ä –æ—Ç –∫–∞–º–µ—Ä–∞—Ç–∞
            </div>
            <div class="module-status">
                <div class="status-indicator status-{{ 'active' if capture_config.status == 'ok' else 'inactive' }}"></div>
                <span>{{ '–ù–∞–ª–∏—á–µ–Ω' if capture_config.status == 'ok' else '–ù–µ–¥–æ—Å—Ç—ä–ø–µ–Ω' }}</span>
            </div>
            <a href="/latest.jpg" class="module-button">–û—Ç–≤–æ—Ä–∏</a>
        </div>
    </div>
    
    <div class="footer">
        <p>PTZ Camera Control System &copy; 2025</p>
    </div>
    
    <script>
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤—è–≤–∞–Ω–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ—Ç–æ –≤—Å–µ–∫–∏ 10 —Å–µ–∫—É–Ω–¥–∏
        setInterval(function() {
            const img = document.querySelector('.main-image img');
            if (img) {
                img.src = '/latest.jpg?ts=' + Date.now();
            }
        }, 10000);
    </script>
</body>
</html>